{"id":"BACH-12w","title":"Integration testing and MCP server setup","description":"Final integration and testing:\n- MCP server entry point with all tools registered\n- Tool schema definitions for MCP\n- Integration tests covering full workflows\n- Manual testing with Claude\n- README with setup and usage instructions\n- Document scaling limits and assumptions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T20:09:38.641037+07:00","updated_at":"2025-12-10T00:27:54.977558+07:00","closed_at":"2025-12-10T00:27:54.977558+07:00","dependencies":[{"issue_id":"BACH-12w","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:24:21.355991+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-12w","depends_on_id":"BACH-3t9","type":"blocks","created_at":"2025-12-09T20:30:04.989143+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-12w","depends_on_id":"BACH-377","type":"blocks","created_at":"2025-12-09T20:30:10.248556+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-12w","depends_on_id":"BACH-3xu","type":"blocks","created_at":"2025-12-09T20:30:15.494972+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-12w","depends_on_id":"BACH-251","type":"blocks","created_at":"2025-12-09T20:30:20.720179+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-12w","depends_on_id":"BACH-29d","type":"blocks","created_at":"2025-12-09T20:30:25.955581+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-251","title":"Human escalation tools - request/submit decision","description":"Implement human-in-the-loop tools:\n- request_human_decision: Create human-targeted notification, block beads\n- submit_human_decision: Record decision, unblock beads, notify agents\n- Support for human:username targeting\n- Bead blocking/unblocking integration with bd CLI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T20:09:27.986064+07:00","updated_at":"2025-12-09T22:21:41.757591+07:00","closed_at":"2025-12-09T22:21:41.757591+07:00","dependencies":[{"issue_id":"BACH-251","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:23:51.787949+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-251","depends_on_id":"BACH-p1p","type":"blocks","created_at":"2025-12-09T20:29:54.46872+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-29d","title":"MCP resources - workflow, status, task, notifications","description":"Implement MCP resources for orchestrator consumption:\n- bacchus://workflow: Full orchestrator protocol documentation\n- bacchus://status: Current tasks, owners, notification counts\n- bacchus://task/{bead_id}: Task details + context bundle\n- bacchus://notifications/{agent_id}: Pending notifications for agent\n\nResources are read-only and provide orchestrator onboarding/status.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T20:09:33.295441+07:00","updated_at":"2025-12-09T22:29:05.385226+07:00","closed_at":"2025-12-09T22:29:05.385226+07:00","dependencies":[{"issue_id":"BACH-29d","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:24:06.870529+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-29d","depends_on_id":"BACH-p1p","type":"blocks","created_at":"2025-12-09T20:29:59.737143+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-2xx","title":"Ship beads-planner skill with correct bd commands and installation","description":"skills/beads-planner.md uses 'beads' CLI in examples, but bacchus integrates with the 'bd' command. The install script only installs skills/SKILL.md, so beads-planner isn't deployed even though global context references it. Update the skill to use 'bd' commands and include it in the install/discovery flow.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T17:21:11.954263+07:00","updated_at":"2025-12-26T17:35:47.473605+07:00","closed_at":"2025-12-26T17:35:47.473605+07:00","close_reason":"Closed"}
{"id":"BACH-35c","title":"Test bead for hook verification","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T12:10:28.739482+07:00","updated_at":"2025-12-28T12:11:44.692589+07:00","closed_at":"2025-12-28T12:11:44.692589+07:00","close_reason":"Closed"}
{"id":"BACH-377","title":"Code/symbol tools - find_symbols and get_task_context","description":"Implement code/symbol query tools:\n- find_symbols: Search symbols by pattern, kind, file glob\n- get_task_context: \n  - Collect related symbols (planned/actual for bead)\n  - Include neighbor symbols from same files\n  - Add related beads and doc fragments\n  - Rank by relevance\n  - Token budgeting (chars/3.5 estimation)\n  - Drift detection (compare start_hash)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T20:09:17.258115+07:00","updated_at":"2025-12-09T22:16:53.22784+07:00","closed_at":"2025-12-09T22:16:53.22784+07:00","dependencies":[{"issue_id":"BACH-377","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:21:28.536802+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-377","depends_on_id":"BACH-p1p","type":"blocks","created_at":"2025-12-09T20:29:38.65677+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-377","depends_on_id":"BACH-rt1","type":"blocks","created_at":"2025-12-09T20:29:43.951094+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-3t9","title":"Coordination tools - claim/release/workplan/footprint/heartbeat","description":"Implement core coordination MCP tools:\n- claim_task: Claim ownership, compute start_hash, integrate with bd CLI\n- release_task: Clear owner, preserve context, call bd update\n- update_workplan: Store workplan, detect stakeholder overlaps, create bead_symbols\n- report_footprint: Lazy indexing, map changes to symbols, detect conflicts, send notifications\n- heartbeat: Update last_heartbeat, return pending notifications\n- list_stale_tasks: Find abandoned tasks by heartbeat threshold\n\nAll tools must integrate with bd CLI for Beads coordination.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T19:52:15.702463+07:00","updated_at":"2025-12-09T22:11:43.212147+07:00","closed_at":"2025-12-09T22:11:43.212147+07:00","dependencies":[{"issue_id":"BACH-3t9","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:21:08.58913+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-3t9","depends_on_id":"BACH-p1p","type":"blocks","created_at":"2025-12-09T20:29:28.134475+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-3t9","depends_on_id":"BACH-rt1","type":"blocks","created_at":"2025-12-09T20:29:33.373854+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-3xu","title":"Communication tools - notifications and stakeholders","description":"Implement inter-agent communication tools:\n- get_notifications: Query pending notifications for an agent\n- resolve_notification: Mark notification as resolved/acknowledged\n- query_symbol_stakeholders: Find agents affected by symbol changes\n  - Direct stakeholders (workplan references symbol)\n  - Transitive stakeholders (grep-based call detection for P0)\n- Auto-notification logic in report_footprint for breaking changes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-09T20:09:22.611789+07:00","updated_at":"2025-12-09T22:19:00.804712+07:00","closed_at":"2025-12-09T22:19:00.804712+07:00","dependencies":[{"issue_id":"BACH-3xu","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:23:01.130064+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-3xu","depends_on_id":"BACH-p1p","type":"blocks","created_at":"2025-12-09T20:29:49.226258+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-49u","title":"Re-review refinements after updates","description":"Review recent refinement updates; provide review findings only.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T19:03:01.839114+07:00","created_by":"vuln","updated_at":"2025-12-28T19:07:51.164909+07:00","closed_at":"2025-12-28T19:07:51.164909+07:00","close_reason":"Closed"}
{"id":"BACH-5ir","title":"Parallelize symbol indexing with rayon","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T00:24:01.045204+07:00","updated_at":"2025-12-26T00:42:50.411941+07:00","closed_at":"2025-12-26T00:42:50.411941+07:00","close_reason":"Parallelized with rayon - 155% CPU utilization, batch DB inserts"}
{"id":"BACH-5oe","title":"Refine claim eligibility rules","description":"Decide whether bacchus claim should enforce ready/open-only (and/or add a --force override) to avoid claiming blocked/in_progress beads.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-28T12:57:28.691457+07:00","created_by":"vuln","updated_at":"2025-12-28T12:57:28.691457+07:00"}
{"id":"BACH-7je","title":"Bacchus P0 - MCP Server Implementation","description":"Implement the P0 milestone of Bacchus - an AST-aware coordination MCP server for multi-agent work on Beads-managed repositories.\n\nKey deliverables:\n- SQLite database with schema for tasks, symbols, bead_symbols, notifications\n- Tree-sitter TypeScript indexer for symbol extraction\n- 14 MCP tools for coordination, code/symbol queries, communication, and human escalation\n- 4 MCP resources for orchestrator onboarding and status\n\nSee BACCHUS-DESIGN.md for full specification.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-09T19:42:46.959071+07:00","updated_at":"2025-12-09T23:40:16.031105+07:00","closed_at":"2025-12-09T23:40:16.031105+07:00"}
{"id":"BACH-8x5","title":"Session check should respect CLAUDE_PROJECT_DIR","description":"bacchus session check uses current_dir only; stop hook may run outside repo root, so session file isn't found and hook always approves. Consider using CLAUDE_PROJECT_DIR (or env override) when resolving workspace root.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T19:18:48.703824+07:00","created_by":"vuln","updated_at":"2025-12-28T19:24:42.613108+07:00","closed_at":"2025-12-28T19:24:42.613108+07:00","close_reason":"Added CLAUDE_PROJECT_DIR support to find_workspace_root() in both main.rs and session.rs"}
{"id":"BACH-bty","title":"Context should resolve DB/worktree root when run inside a worktree","description":"Running bacchus context from .bacchus/worktrees/* initializes a new .bacchus/bacchus.db in the worktree, so claims/ready output is empty. Context also checks for the hard-coded string '.bacchus/worktrees', ignoring BACCHUS_WORKTREES and Windows path separators. Resolve the workspace root (e.g., by following the worktree .git pointer or using worktree::get_worktrees_dir) and use the canonical DB/worktree paths.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-26T17:21:00.193874+07:00","updated_at":"2025-12-26T17:35:39.341014+07:00","closed_at":"2025-12-26T17:35:39.341014+07:00","close_reason":"Closed"}
{"id":"BACH-cxk","title":"Stop hook should handle bacchus session check failures","description":"plugin/hooks/stop-router.sh delegates to 'bacchus session check' without checking exit status; if bacchus/db init fails, hook may emit no JSON. Consider fallback approve with reason.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T19:07:07.766301+07:00","created_by":"vuln","updated_at":"2025-12-28T19:12:43.595425+07:00","closed_at":"2025-12-28T19:12:43.595425+07:00","close_reason":"Fixed in this commit"}
{"id":"BACH-duf","title":"Resolve workspace root from worktree .git file for external worktrees","description":"When BACCHUS_WORKTREES points outside the repo and bacchus is run inside that worktree, find_workspace_root walks upward looking for .bacchus/.beads or a .git *directory* and falls back to the worktree path. That causes the DB path to resolve to worktree/.bacchus/bacchus.db and yields empty context unless BACCHUS_DB_PATH is set. Consider parsing the .git file to locate the main repo (gitdir) and set workspace_root accordingly.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-26T17:44:39.753405+07:00","updated_at":"2025-12-26T17:53:15.250778+07:00","closed_at":"2025-12-26T17:53:15.250778+07:00","close_reason":"Closed"}
{"id":"BACH-f1j","title":"Project setup - TypeScript/Node structure","description":"Initialize the Bacchus project:\n- bun init with TypeScript\n- Add dependencies: @modelcontextprotocol/sdk, better-sqlite3, tree-sitter, tree-sitter-typescript\n- Create project structure: src/db/, src/indexer/, src/tools/, src/resources/\n- Set up tsconfig.json with strict mode\n- Add basic test framework (vitest)\n- Create .bacchus/ directory structure","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T19:44:17.564529+07:00","updated_at":"2025-12-09T20:40:29.210368+07:00","closed_at":"2025-12-09T20:40:29.210368+07:00","dependencies":[{"issue_id":"BACH-f1j","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:19:50.938136+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-hj4","title":"Test session hook","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-28T12:21:07.79599+07:00","updated_at":"2025-12-28T12:21:37.33347+07:00","closed_at":"2025-12-28T12:21:37.33347+07:00","close_reason":"Closed"}
{"id":"BACH-hkj","title":"Re-review before release","description":"Review latest changes; report findings only.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T19:15:45.260214+07:00","created_by":"vuln","updated_at":"2025-12-28T19:20:52.799979+07:00","closed_at":"2025-12-28T19:20:52.799979+07:00","close_reason":"Closed"}
{"id":"BACH-jyu","title":"Session check should consider in_progress without claims","description":"check_orchestrator_session only considers ready_beads and active claims; in_progress beads without claims will allow exit. Consider using bd status or another signal.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T19:07:02.954428+07:00","created_by":"vuln","updated_at":"2025-12-28T19:12:43.592576+07:00","closed_at":"2025-12-28T19:12:43.592576+07:00","close_reason":"Fixed in this commit"}
{"id":"BACH-p1p","title":"Database layer - Schema and migrations","description":"Implement the database foundation:\n- Schema migrations system (numbered SQL files)\n- Initial migration with all tables:\n  - tasks (bead_id, title, status, owner, workplan, footprint, start_hash, last_heartbeat, last_update)\n  - symbols (id, file, fq_name, kind, span_start_line, span_end_line, line_count, hash, docstring)\n  - bead_symbols (bead_id, symbol_ref, symbol_id, relation, is_virtual)\n  - notifications (all fields from design)\n  - symbol_calls (caller_symbol_id, callee_fq_name, call_site_file, call_site_line)\n  - doc_fragments, doc_sources\n- Database connection/initialization module\n- Basic CRUD operations for each table\n- WAL mode for concurrency","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T19:44:36.300885+07:00","updated_at":"2025-12-09T21:20:59.535517+07:00","closed_at":"2025-12-09T21:20:59.535517+07:00","dependencies":[{"issue_id":"BACH-p1p","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:20:23.679432+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-p1p","depends_on_id":"BACH-f1j","type":"blocks","created_at":"2025-12-09T20:25:34.473212+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-qev","title":"Review plugin changes and stop hooks","description":"Review recent changes for plugin conversion and stop hooks; provide code review findings.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:32:34.260883+07:00","updated_at":"2025-12-28T12:39:31.92484+07:00","closed_at":"2025-12-28T12:39:31.92484+07:00","close_reason":"Closed"}
{"id":"BACH-qlo","title":"Re-review plugin and stop hook fixes","description":"Re-review recent fixes for plugin conversion and stop hooks; provide review findings only.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:49:11.545526+07:00","created_by":"vuln","updated_at":"2025-12-28T12:54:20.604827+07:00","closed_at":"2025-12-28T12:54:20.604827+07:00","close_reason":"Closed"}
{"id":"BACH-rjk","title":"Document bacchus context command in README/skill docs","description":"The new 'bacchus context' command isn't mentioned in README.md or skills/SKILL.md. Add usage guidance and examples so users know how to generate global vs task context (including --bead-id).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T17:21:23.48433+07:00","updated_at":"2025-12-26T17:35:55.771367+07:00","closed_at":"2025-12-26T17:35:55.771367+07:00","close_reason":"Closed"}
{"id":"BACH-rt1","title":"AST indexer - Tree-sitter TypeScript","description":"Implement the symbol indexer:\n- Tree-sitter TypeScript parser integration\n- Symbol extraction for: functions, classes, methods, interfaces, type aliases, React hooks\n- Fully-qualified name generation (file::class::method format)\n- Hash computation for symbol bodies (for change detection)\n- Line span tracking (span_start_line, span_end_line, line_count)\n- Docstring extraction (leading comments)\n- File re-indexing on demand\n- Unit tests for symbol extraction","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-09T19:45:09.056308+07:00","updated_at":"2025-12-09T22:04:13.354559+07:00","closed_at":"2025-12-09T22:04:13.354559+07:00","dependencies":[{"issue_id":"BACH-rt1","depends_on_id":"BACH-7je","type":"parent-child","created_at":"2025-12-09T20:20:46.120031+07:00","created_by":"vuln","metadata":"{}"},{"issue_id":"BACH-rt1","depends_on_id":"BACH-f1j","type":"blocks","created_at":"2025-12-09T20:26:33.917071+07:00","created_by":"vuln","metadata":"{}"}]}
{"id":"BACH-xd0","title":"Update stop-prompt doc for session status JSON shape","description":"plugin/hooks/stop-prompt.md expects top-level mode/bead_id, but bacchus session status returns {active, session{...}, path}. Align doc.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T19:06:56.822823+07:00","created_by":"vuln","updated_at":"2025-12-28T19:12:43.596857+07:00","closed_at":"2025-12-28T19:12:43.596857+07:00","close_reason":"Fixed in this commit"}
{"id":"BACH-zqe","title":"Bacchus v2 - Worktree-based Simplification","description":"Simplify bacchus to focus on worktree-based agent isolation with tight beads integration. Remove coordination complexity (workplan, footprint, heartbeat, notifications). Core commands: next, release, stale, status.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:29:03.021663+07:00","updated_at":"2025-12-26T00:12:19.882929+07:00","closed_at":"2025-12-26T00:12:19.882929+07:00","close_reason":"All subtasks complete: next/release/stale implemented, status enhanced, tests written, docs updated"}
{"id":"BACH-zqe.1","title":"Beads integration layer","description":"Add module to read beads DB (or call bd CLI). Functions needed:\n- get_ready_beads() -\u003e list of beads with status=ready\n- update_bead_status(bead_id, status) -\u003e update status in beads\n- get_bead_context(bead_id) -\u003e title, description for agent context\n\nDecide: read SQLite directly vs shell out to bd CLI. Direct DB is faster but couples to beads internals.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:30:22.699816+07:00","updated_at":"2025-12-24T14:21:45.812365+07:00","closed_at":"2025-12-24T14:21:45.812367+07:00","dependencies":[{"issue_id":"BACH-zqe.1","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:30:22.70071+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.10","title":"Update skill documentation","description":"Update ~/.claude/skills/bacchus/SKILL.md to reflect v2 API:\n\n- Remove old commands (workplan, footprint, heartbeat, notifications, etc.)\n- Document new commands: next, release, stale, status\n- Update workflow diagram\n- Add examples for common scenarios\n- Document worktree structure","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-24T13:01:46.351211+07:00","updated_at":"2025-12-26T00:12:11.230335+07:00","closed_at":"2025-12-26T00:12:11.230335+07:00","close_reason":"Added merge conflict handling, status output fields, list, updates, and workflow commands","dependencies":[{"issue_id":"BACH-zqe.10","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T13:01:46.351966+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.10","depends_on_id":"BACH-zqe.9","type":"blocks","created_at":"2025-12-24T13:04:36.224622+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.2","title":"Worktree management module","description":"Git worktree operations:\n- create_worktree(bead_id) -\u003e creates .bacchus/worktrees/{bead_id} on branch bacchus/{bead_id}\n- remove_worktree(bead_id, force) -\u003e removes worktree and deletes branch\n- list_worktrees() -\u003e list active worktrees with metadata\n- merge_worktree(bead_id, target_branch) -\u003e merge worktree branch to target\n\nUse std::process::Command to call git. Handle errors gracefully.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:41:05.954+07:00","updated_at":"2025-12-24T14:21:51.270469+07:00","closed_at":"2025-12-24T14:21:51.270472+07:00","dependencies":[{"issue_id":"BACH-zqe.2","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:41:05.955159+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.3","title":"Implement 'bacchus next' command","description":"Core command for agents to get work:\n\nbacchus next \u003cagent-id\u003e\n\n1. Query beads for ready tasks (via beads integration)\n2. Pick one (first available, or could add priority logic)\n3. Create worktree: git worktree add .bacchus/worktrees/BEAD-X -b bacchus/BEAD-X\n4. Record claim in bacchus DB: agent_id, bead_id, worktree_path, start_time, start_commit\n5. Update bead status to in_progress\n6. Return JSON: { bead_id, title, description, worktree_path, branch }\n\nAgent then works entirely within worktree_path.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:53:49.509278+07:00","updated_at":"2025-12-25T23:56:10.855295+07:00","closed_at":"2025-12-25T23:56:10.855295+07:00","close_reason":"Implemented: commands working in main.rs, old files removed, schema simplified via migration 3","dependencies":[{"issue_id":"BACH-zqe.3","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:53:49.510227+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.3","depends_on_id":"BACH-zqe.1","type":"blocks","created_at":"2025-12-24T13:03:53.503571+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.3","depends_on_id":"BACH-zqe.2","type":"blocks","created_at":"2025-12-24T13:03:58.846366+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.3","depends_on_id":"BACH-zqe.7","type":"blocks","created_at":"2025-12-24T13:04:04.186343+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.4","title":"Implement 'bacchus release' command","description":"Release a claimed task with cleanup:\n\nbacchus release \u003cbead-id\u003e [--done|--blocked|--failed]\n\n--done (default):\n1. Verify agent owns the claim\n2. Merge worktree branch to main (or target branch)\n3. Remove worktree: git worktree remove .bacchus/worktrees/BEAD-X\n4. Delete branch: git branch -d bacchus/BEAD-X\n5. Update bead status to done\n6. Remove claim from bacchus DB\n\n--blocked:\n1-4 same but update bead status to blocked\n5. Could optionally preserve branch for later\n\n--failed:\n1. Remove worktree with --force (discard changes)\n2. Delete branch with -D (force)\n3. Update bead status back to ready (for retry)\n4. Remove claim","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:54:53.471218+07:00","updated_at":"2025-12-25T23:56:10.857069+07:00","closed_at":"2025-12-25T23:56:10.857069+07:00","close_reason":"Implemented: commands working in main.rs, old files removed, schema simplified via migration 3","dependencies":[{"issue_id":"BACH-zqe.4","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:54:53.472063+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.4","depends_on_id":"BACH-zqe.2","type":"blocks","created_at":"2025-12-24T13:04:09.530583+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.5","title":"Implement 'bacchus stale' command","description":"Find and cleanup abandoned tasks:\n\nbacchus stale [--minutes N] [--cleanup]\n\nDefault (no --cleanup):\n1. Find claims older than N minutes (default 15)\n2. List them with: bead_id, agent_id, worktree_path, age, branch\n\nWith --cleanup:\n1. For each stale claim:\n   - git worktree remove \u003cpath\u003e --force\n   - git branch -D bacchus/\u003cbead-id\u003e\n   - Update bead status back to ready\n   - Remove claim from bacchus DB\n2. Report what was cleaned up\n\nThis is the recovery mechanism for crashed/stuck agents.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-24T12:55:26.11601+07:00","updated_at":"2025-12-25T23:56:10.85787+07:00","closed_at":"2025-12-25T23:56:10.85787+07:00","close_reason":"Implemented: commands working in main.rs, old files removed, schema simplified via migration 3","dependencies":[{"issue_id":"BACH-zqe.5","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:55:26.116827+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.5","depends_on_id":"BACH-zqe.2","type":"blocks","created_at":"2025-12-24T13:04:14.877258+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.6","title":"Remove old coordination complexity","description":"Delete code for deprecated features:\n\nRemove from CLI:\n- workplan command\n- footprint command  \n- heartbeat command\n- notifications command\n- resolve command\n- stakeholders command\n- notify command\n- decide command\n- answer command\n- pending command\n- context command (or keep if useful)\n\nRemove from tools/:\n- coordination.rs: workplan, footprint, heartbeat functions\n- communication.rs: entire file likely\n\nRemove from DB schema:\n- notifications table\n- symbol_calls table\n- doc_fragments table\n- doc_sources table\n- bead_symbols table (unless keeping for search)\n\nKeep:\n- tasks table (simplified: bead_id, agent_id, worktree_path, claimed_at)\n- symbols table (for search)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T12:56:16.380913+07:00","updated_at":"2025-12-25T23:56:10.858647+07:00","closed_at":"2025-12-25T23:56:10.858647+07:00","close_reason":"Implemented: commands working in main.rs, old files removed, schema simplified via migration 3","dependencies":[{"issue_id":"BACH-zqe.6","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:56:16.381862+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.7","title":"Simplify DB schema","description":"New minimal schema:\n\n-- Claims table (replaces tasks)\nCREATE TABLE claims (\n  bead_id TEXT PRIMARY KEY,\n  agent_id TEXT NOT NULL,\n  worktree_path TEXT NOT NULL,\n  branch_name TEXT NOT NULL,\n  start_commit TEXT NOT NULL,\n  claimed_at INTEGER NOT NULL\n);\n\n-- Keep symbols table for search (optional)\nCREATE TABLE symbols (\n  id INTEGER PRIMARY KEY,\n  file TEXT NOT NULL,\n  fq_name TEXT NOT NULL,\n  kind TEXT NOT NULL,\n  span_start_line INTEGER NOT NULL,\n  span_end_line INTEGER NOT NULL,\n  line_count INTEGER NOT NULL,\n  hash TEXT NOT NULL,\n  language TEXT NOT NULL\n);\n\nWrite migration from v2 -\u003e v3 that drops old tables.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T12:56:44.32441+07:00","updated_at":"2025-12-24T14:21:56.676221+07:00","closed_at":"2025-12-24T14:21:56.676225+07:00","dependencies":[{"issue_id":"BACH-zqe.7","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T12:56:44.325312+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.8","title":"Update 'bacchus status' command","description":"Show current state:\n\nbacchus status\n\nOutput:\n{\n  \"claims\": [\n    {\n      \"bead_id\": \"BACH-123\",\n      \"agent_id\": \"agent-1\",\n      \"worktree\": \".bacchus/worktrees/BACH-123\",\n      \"branch\": \"bacchus/BACH-123\",\n      \"claimed_at\": \"2024-01-15T10:30:00Z\",\n      \"age_minutes\": 5\n    }\n  ],\n  \"worktrees\": 1,\n  \"ready_beads\": 3\n}\n\nAlso show if any worktrees exist without claims (orphaned) or claims without worktrees (broken).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T13:00:32.64834+07:00","updated_at":"2025-12-26T00:02:00.568856+07:00","closed_at":"2025-12-26T00:02:00.568856+07:00","close_reason":"Added ready_beads count, orphaned_worktrees, and broken_claims detection","dependencies":[{"issue_id":"BACH-zqe.8","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T13:00:32.649072+07:00","created_by":"vuln"}]}
{"id":"BACH-zqe.9","title":"Integration tests","description":"End-to-end tests for the new workflow:\n\n1. Test next command:\n   - Creates worktree in correct location\n   - Creates branch with correct name\n   - Records claim in DB\n   - Updates bead status\n\n2. Test release --done:\n   - Merges changes to main\n   - Removes worktree\n   - Deletes branch\n   - Updates bead status\n   - Removes claim\n\n3. Test release --failed:\n   - Discards changes\n   - Removes worktree\n   - Bead goes back to ready\n\n4. Test stale --cleanup:\n   - Finds old claims\n   - Cleans up worktrees\n   - Resets bead status\n\n5. Test error cases:\n   - No ready beads\n   - Worktree already exists\n   - Merge conflicts\n   - Invalid bead_id\n\nUse tempdir for test repos. Mock beads DB or use in-memory.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-24T13:01:05.088414+07:00","updated_at":"2025-12-26T00:09:23.512154+07:00","closed_at":"2025-12-26T00:09:23.512154+07:00","close_reason":"17 integration tests covering worktrees, DB, symbols, CLI, workflow, and error cases","dependencies":[{"issue_id":"BACH-zqe.9","depends_on_id":"BACH-zqe","type":"parent-child","created_at":"2025-12-24T13:01:05.08923+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.9","depends_on_id":"BACH-zqe.3","type":"blocks","created_at":"2025-12-24T13:04:20.207535+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.9","depends_on_id":"BACH-zqe.4","type":"blocks","created_at":"2025-12-24T13:04:25.556833+07:00","created_by":"vuln"},{"issue_id":"BACH-zqe.9","depends_on_id":"BACH-zqe.5","type":"blocks","created_at":"2025-12-24T13:04:30.898351+07:00","created_by":"vuln"}]}
